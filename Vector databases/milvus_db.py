# Milvus container runnen

# Invoke-WebRequest https://github.com/milvus-io/milvus/releases/download/v2.4.15/milvus-standalone-docker-compose.yml -OutFile docker-compose.yml
# docker compose up -d

from pymilvus import connections, utility, Collection, FieldSchema, CollectionSchema, DataType
from pymilvus.exceptions import MilvusException
from sentence_transformers import SentenceTransformer
import json

# Step 1: Connect to Milvus
connections.connect(host="localhost", port="19530")

# Step 2: Define the schema for the collection
vector_field = FieldSchema(name="embedding", dtype=DataType.FLOAT_VECTOR, dim=384)
id_field = FieldSchema(name="id", dtype=DataType.INT64, is_primary=True, auto_id=True)
name_field = FieldSchema(name="name", dtype=DataType.VARCHAR, max_length=255)
url_field = FieldSchema(name="url", dtype=DataType.VARCHAR, max_length=512)

# Create collection schema
schema = CollectionSchema(fields=[id_field, vector_field, name_field, url_field], description="Product collection")

# Step 3: Create the collection
collection_name = "product_collection"
try:
    if utility.has_collection(collection_name):
        print(f"Collection '{collection_name}' already exists. Dropping it.")
        utility.drop_collection(collection_name)  # Drop existing collection
    collection = Collection(name=collection_name, schema=schema)
    print(f"Collection '{collection_name}' created successfully.")
except MilvusException as e:
    print(f"Error creating collection: {e}")

# Load the SentenceTransformer model
model = SentenceTransformer('all-MiniLM-L6-v2')  # 384-dimensional vectors

# Step 4: Insert Multiple Products
products = [
    {
        "name": "Acer Chromebook 315 (CB315-4H-C8T6)",
        "rating": "9,7/10 (34 reviews)",
        "price": "349,-",
        "articlenumber": "911648",
        "manufacturercode": "NX.KB9EH.001",
        "brand": "Acer",
        "warranty": "2 jaar",
        "handling_of_your_defect": "Via Coolblue",
        "old_device_return_for_free": "Ja",
        "internal_ram_memory": "4 GB",
        "graphics_card_chipset": "Intel UHD Graphics",
        "touchscreen": "Nee",
        "usb_type": "Standaard usb-A, Usb-C",
        "Recommended_usage": "Films en series streamen, Internet, email en tekstverwerken",
        "speed_class": "Basisklasse",
        "build_quality": "Basisklasse",
        "screen_diagonal": "15,6 inch",
        "screen_resolution": "Full HD (1080p)",
        "screen_resolution_width": "1920 pixels",
        "screen_resolution_height": "1080 pixels",
        "refresh_rate": "60 Hz",
        "touch_screen": "Nee",
        "screen_reflection": "Anti reflecterend",
        "paneltype": "IPS paneel",
        "adaptive_sync": "Nee",
        "processor_name": "Intel Celeron",
        "processor_number": "N4500",
        "processor_core": "Dual core (2)",
        "processor_codename": "Jasper Lake",
        "processor_clockspeed": "1,1 GHz",
        "processor_clockspeed_turbo": "2,8 GHz",
        "processor_cachememory": "4 MB",
        "intern_ram": "4 GB",
        "ram_composition": "1 x 4 GB",
        "ram_slot_1": "4 GB",
        "ram_slots": "1",
        "storage_type": "eMMC",
        "total_storage_capacity": "64 GB",
        "storage_disk_type": "eMMC",
        "gpu_chipset": "Intel UHD Graphics",
        "gpu_type": "Shared",
        "operating_system": "Google Chrome OS",
        "operating_system_language": "Meerdere talen in te stellen",
        "model_laptop": "Laptop",
        "color": "Zilver",
        "material": "Kunststof",
        "height": "2 cm",
        "width": "36,64 cm",
        "depth": "24,42 cm",
        "weight": "1,6 kg",
        "mobile_dataconnection": "Geen",
        "bluetooth": "Ja",
        "bluetooth_version": "5.0",
        "usb_connection": "Ja",
        "amount_of_usb_connections": "4",
        "usb_connection_type": "Standaard usb-A, Usb-C",
        "protocol_female_usb_c_port": "DisplayPort Alternatieve Modus, USB, USB elektriciteit",
        "usb_version_female_usb_c_port": "3.1",
        "video_output_via_usb_c_port": "Ja",
        "amount_of_female_standard_usb_a_ports": "2",
        "usb_version_female_standard_usb_a_ports": "3.0",
        "amount_of_usb_3_1_female_usb_c_ports": "2",
        "hdmi_connection": "Nee",
        "displayport_connection": "Nee",
        "vga_connection": "Nee",
        "thunderbolt_connection": "Nee",
        "headphone_jack": "Ja",
        "keyboard_layout": "QWERTY",
        "physical_keyboard_layout": "ANSI",
        "numeric_keyboard": "Nee",
        "stain_resistant": "Nee",
        "keyboard_backlight": "Nee",
        "mechanical_keyboard": "Nee",
        "programmable_keys": "Nee",
        "microphone": "Ja",
        "amount_of_speakers": "2",
        "audio_type": "Stereo",
        "built_in_camera": "Ja",
        "camera_resolution": "HD Ready (720p)",
        "battery_type": "Lithium-ion",
        "battery_capacity": "4,5 uur",
        "TPM": "Ja",
        "kensington_lock": "Ja",
        "windows_hello": "Nee",
        "fingerprint_sensor": "Nee",
        "security_class": "Middenklasse",
        "amount_of_free_ram_slots": "0",
        "extra_software": "Nee",
        "url": "https://www.coolblue.nl/product/911648/acer-chromebook-315-cb315-4h-c8t6.html"
    },
    {
        "name": "Acer Chromebook 314 (CB314-3H-C99X)",
        "rating": "9,0/10 (16 reviews)",
        "price": "456,-",
        "articlenumber": "911646",
        "manufacturercode": "NX.KB4EH.001",
        "brand": "Acer",
        "warranty": "2 jaar",
        "handling_of_your_defect": "Via Coolblue",
        "old_device_return_for_free": "Ja",
        "internal_ram_memory": "4 GB",
        "graphics_card_chipset": "Intel UHD Graphics",
        "touchscreen": "Nee",
        "usb_type": "Standaard usb-A, Usb-C",
        "Recommended_usage": "Films en series streamen, Internet, email en tekstverwerken",
        "speed_class": "Basisklasse",
        "build_quality": "Basisklasse",
        "screen_diagonal": "14 inch",
        "screen_resolution": "Full HD (1080p)",
        "screen_resolution_width": "1920 pixels",
        "screen_resolution_height": "1080 pixels",
        "refresh_rate": "60 Hz",
        "touch_screen": "Nee",
        "screen_reflection": "Anti reflecterend",
        "paneltype": "IPS paneel",
        "adaptive_sync": "Nee",
        "processor_name": "Intel Celeron",
        "processor_number": "N4500",
        "processor_core": "Dual core (2)",
        "processor_codename": "Jasper Lake",
        "processor_clockspeed": "1,1 GHz",
        "processor_clockspeed_turbo": "2,8 GHz",
        "processor_cachememory": "4 MB",
        "intern_ram": "4 GB",
        "ram_composition": "1 x 4 GB",
        "ram_slot_1": "4 GB",
        "ram_slots": "1",
        "storage_type": "eMMC",
        "total_storage_capacity": "64 GB",
        "storage_disk_type": "eMMC",
        "gpu_chipset": "Intel UHD Graphics",
        "gpu_type": "Shared",
        "operating_system": "Google Chrome OS",
        "operating_system_language": "Meerdere talen in te stellen",
        "model_laptop": "Laptop",
        "color": "Zilver",
        "material": "Kunststof",
        "height": "2 cm",
        "width": "32,64 cm",
        "depth": "22,5 cm",
        "weight": "1,45 kg",
        "mobile_dataconnection": "Geen",
        "bluetooth": "Ja",
        "bluetooth_version": "5.0",
        "usb_connection": "Ja",
        "amount_of_usb_connections": "4",
        "usb_connection_type": "Standaard usb-A, Usb-C",
        "protocol_female_usb_c_port": "DisplayPort Alternatieve Modus, USB, USB elektriciteit",
        "usb_version_female_usb_c_port": "3.1",
        "video_output_via_usb_c_port": "Ja",
        "amount_of_female_standard_usb_a_ports": "2",
        "usb_version_female_standard_usb_a_ports": "3.0",
        "amount_of_usb_3_1_female_usb_c_ports": "2",
        "hdmi_connection": "Nee",
        "displayport_connection": "Nee",
        "vga_connection": "Nee",
        "thunderbolt_connection": "Nee",
        "headphone_jack": "Ja",
        "keyboard_layout": "QWERTY",
        "physical_keyboard_layout": "ANSI",
        "numeric_keyboard": "Nee",
        "stain_resistant": "Nee",
        "keyboard_backlight": "Nee",
        "mechanical_keyboard": "Nee",
        "programmable_keys": "Nee",
        "microphone": "Ja",
        "amount_of_speakers": "2",
        "audio_type": "Stereo",
        "built_in_camera": "Ja",
        "camera_resolution": "HD Ready (720p)",
        "battery_type": "Lithium-ion",
        "battery_capacity": "8 uur",
        "TPM": "Ja",
        "kensington_lock": "Ja",
        "windows_hello": "Nee",
        "fingerprint_sensor": "Nee",
        "security_class": "Middenklasse",
        "amount_of_free_ram_slots": "0",
        "extra_software": "Nee",
        "url": "https://www.coolblue.nl/product/911646/acer-chromebook-314-cb314-3h-c99x.html"
    },
    {
        "name": "Lenovo ThinkPad X1 Carbon Gen 9",
        "rating": "8,8/10 (42 reviews)",
        "price": "1.799,-",
        "articlenumber": "920234",
        "manufacturercode": "20U3002MUS",
        "brand": "Lenovo",
        "warranty": "3 jaar",
        "handling_of_your_defect": "Via Lenovo",
        "old_device_return_for_free": "Ja",
        "internal_ram_memory": "16 GB",
        "graphics_card_chipset": "Intel Iris Xe Graphics",
        "touchscreen": "Ja",
        "usb_type": "USB-A, USB-C",
        "Recommended_usage": "Zakelijk gebruik, Programmeren, Zware multitasking",
        "speed_class": "Hoge prestaties",
        "build_quality": "Premium",
        "screen_diagonal": "14 inch",
        "screen_resolution": "WQHD (2560x1600)",
        "screen_resolution_width": "2560 pixels",
        "screen_resolution_height": "1600 pixels",
        "refresh_rate": "90 Hz",
        "touch_screen": "Ja",
        "screen_reflection": "Mat",
        "paneltype": "IPS paneel",
        "adaptive_sync": "Ja",
        "processor_name": "Intel Core i7",
        "processor_number": "1165G7",
        "processor_core": "Quad core (4)",
        "processor_codename": "Tiger Lake",
        "processor_clockspeed": "2,8 GHz",
        "processor_clockspeed_turbo": "4,7 GHz",
        "processor_cachememory": "12 MB",
        "intern_ram": "16 GB",
        "ram_composition": "1 x 16 GB",
        "ram_slot_1": "16 GB",
        "ram_slots": "1",
        "storage_type": "SSD",
        "total_storage_capacity": "512 GB",
        "storage_disk_type": "SSD",
        "gpu_chipset": "Intel Iris Xe Graphics",
        "gpu_type": "Shared",
        "operating_system": "Windows 10 Pro",
        "operating_system_language": "Meerdere talen in te stellen",
        "model_laptop": "Laptop",
        "color": "Zwart",
        "material": "Carbon Fiber",
        "height": "1,4 cm",
        "width": "31,2 cm",
        "depth": "22,4 cm",
        "weight": "1,1 kg",
        "mobile_dataconnection": "4G",
        "bluetooth": "Ja",
        "bluetooth_version": "5.1",
        "usb_connection": "Ja",
        "amount_of_usb_connections": "3",
        "usb_connection_type": "USB-A, USB-C",
        "protocol_female_usb_c_port": "DisplayPort Alternatieve Modus, USB, USB elektriciteit",
        "usb_version_female_usb_c_port": "3.2",
        "video_output_via_usb_c_port": "Ja",
        "amount_of_female_standard_usb_a_ports": "2",
        "usb_version_female_standard_usb_a_ports": "3.0",
        "hdmi_connection": "Ja",
        "displayport_connection": "Ja",
        "vga_connection": "Nee",
        "thunderbolt_connection": "Ja",
        "headphone_jack": "Ja",
        "keyboard_layout": "QWERTY",
        "physical_keyboard_layout": "ANSI",
        "numeric_keyboard": "Ja",
        "stain_resistant": "Ja",
        "keyboard_backlight": "Ja",
        "mechanical_keyboard": "Nee",
        "programmable_keys": "Ja",
        "microphone": "Ja",
        "amount_of_speakers": "4",
        "audio_type": "Dolby Audio",
        "built_in_camera": "Ja",
        "camera_resolution": "HD (720p)",
        "battery_type": "Lithium-ion",
        "battery_capacity": "15 uur",
        "TPM": "Ja",
        "kensington_lock": "Ja",
        "windows_hello": "Ja",
        "fingerprint_sensor": "Ja",
        "security_class": "Hoge klasse",
        "amount_of_free_ram_slots": "0",
        "extra_software": "Microsoft Office 365",
        "url": "https://www.lenovo.com/thinkpad-x1-carbon-gen-9"
    },
    {
        "name": "HP Spectre x360 13",
        "rating": "9,2/10 (60 reviews)",
        "price": "1.499,-",
        "articlenumber": "923847",
        "manufacturercode": "9F5G9EA#ABH",
        "brand": "HP",
        "warranty": "2 jaar",
        "handling_of_your_defect": "Via HP",
        "old_device_return_for_free": "Ja",
        "internal_ram_memory": "8 GB",
        "graphics_card_chipset": "Intel Iris Xe Graphics",
        "touchscreen": "Ja",
        "usb_type": "USB-A, USB-C",
        "Recommended_usage": "Creatieve software, Multimedia en entertainment, Zakelijk gebruik",
        "speed_class": "Hoge prestaties",
        "build_quality": "Premium",
        "screen_diagonal": "13,3 inch",
        "screen_resolution": "4K UHD (3840x2160)",
        "screen_resolution_width": "3840 pixels",
        "screen_resolution_height": "2160 pixels",
        "refresh_rate": "60 Hz",
        "touch_screen": "Ja",
        "screen_reflection": "Glanzend",
        "paneltype": "IPS paneel",
        "adaptive_sync": "Ja",
        "processor_name": "Intel Core i7",
        "processor_number": "1165G7",
        "processor_core": "Quad core (4)",
        "processor_codename": "Tiger Lake",
        "processor_clockspeed": "2,8 GHz",
        "processor_clockspeed_turbo": "4,7 GHz",
        "processor_cachememory": "12 MB",
        "intern_ram": "8 GB",
        "ram_composition": "1 x 8 GB",
        "ram_slot_1": "8 GB",
        "ram_slots": "1",
        "storage_type": "SSD",
        "total_storage_capacity": "512 GB",
        "storage_disk_type": "SSD",
        "gpu_chipset": "Intel Iris Xe Graphics",
        "gpu_type": "Shared",
        "operating_system": "Windows 10 Home",
        "operating_system_language": "Meerdere talen in te stellen",
        "model_laptop": "Laptop",
        "color": "Silver",
        "material": "Aluminum",
        "height": "1,5 cm",
        "width": "30,6 cm",
        "depth": "19,7 cm",
        "weight": "1,3 kg",
        "mobile_dataconnection": "Geen",
        "bluetooth": "Ja",
        "bluetooth_version": "5.0",
        "usb_connection": "Ja",
        "amount_of_usb_connections": "3",
        "usb_connection_type": "USB-A, USB-C",
        "protocol_female_usb_c_port": "USB, USB elektriciteit",
        "usb_version_female_usb_c_port": "3.1",
        "video_output_via_usb_c_port": "Ja",
        "amount_of_female_standard_usb_a_ports": "2",
        "usb_version_female_standard_usb_a_ports": "3.0",
        "hdmi_connection": "Ja",
        "displayport_connection": "Nee",
        "vga_connection": "Nee",
        "thunderbolt_connection": "Ja",
        "headphone_jack": "Ja",
        "keyboard_layout": "QWERTY",
        "physical_keyboard_layout": "ANSI",
        "numeric_keyboard": "Nee",
        "stain_resistant": "Ja",
        "keyboard_backlight": "Ja",
        "mechanical_keyboard": "Nee",
        "programmable_keys": "Nee",
        "microphone": "Ja",
        "amount_of_speakers": "2",
        "audio_type": "Bang & Olufsen",
        "built_in_camera": "Ja",
        "camera_resolution": "HD (720p)",
        "battery_type": "Lithium-ion",
        "battery_capacity": "12 uur",
        "TPM": "Ja",
        "kensington_lock": "Ja",
        "windows_hello": "Ja",
        "fingerprint_sensor": "Ja",
        "security_class": "Premium",
        "amount_of_free_ram_slots": "0",
        "extra_software": "Microsoft Office 365",
        "url": "https://www.hp.com/spectre-x360"
    },
    {
        "name": "Apple MacBook Air M2 (2023)",
        "rating": "9,8/10 (102 reviews)",
        "price": "1.499,-",
        "articlenumber": "943890",
        "manufacturercode": "MMGG3LL/A",
        "brand": "Apple",
        "warranty": "1 jaar",
        "handling_of_your_defect": "Via Apple",
        "old_device_return_for_free": "Ja",
        "internal_ram_memory": "8 GB",
        "graphics_card_chipset": "Apple M2 GPU",
        "touchscreen": "Nee",
        "usb_type": "USB-C",
        "Recommended_usage": "Multimedia, Fotobewerking, Zakelijk gebruik",
        "speed_class": "Hoge prestaties",
        "build_quality": "Premium",
        "screen_diagonal": "13,6 inch",
        "screen_resolution": "Liquid Retina (2560x1664)",
        "screen_resolution_width": "2560 pixels",
        "screen_resolution_height": "1664 pixels",
        "refresh_rate": "60 Hz",
        "touch_screen": "Nee",
        "screen_reflection": "Glanzend",
        "paneltype": "Retina",
        "adaptive_sync": "Ja",
        "processor_name": "Apple M2",
        "processor_number": "M2",
        "processor_core": "8-core",
        "processor_codename": "M2",
        "processor_clockspeed": "3,5 GHz",
        "processor_clockspeed_turbo": "3,5 GHz",
        "processor_cachememory": "16 MB",
        "intern_ram": "8 GB",
        "ram_composition": "1 x 8 GB",
        "ram_slot_1": "8 GB",
        "ram_slots": "1",
        "storage_type": "SSD",
        "total_storage_capacity": "256 GB",
        "storage_disk_type": "SSD",
        "gpu_chipset": "Apple M2 GPU",
        "gpu_type": "Shared",
        "operating_system": "macOS",
        "operating_system_language": "Meerdere talen in te stellen",
        "model_laptop": "Laptop",
        "color": "Space Gray",
        "material": "Aluminum",
        "height": "1,13 cm",
        "width": "30,41 cm",
        "depth": "21,24 cm",
        "weight": "1,24 kg",
        "mobile_dataconnection": "Geen",
        "bluetooth": "Ja",
        "bluetooth_version": "5.0",
        "usb_connection": "Ja",
        "amount_of_usb_connections": "2",
        "usb_connection_type": "USB-C",
        "protocol_female_usb_c_port": "USB, USB elektriciteit",
        "usb_version_female_usb_c_port": "3.1",
        "video_output_via_usb_c_port": "Ja",
        "amount_of_female_standard_usb_a_ports": "0",
        "hdmi_connection": "Nee",
        "displayport_connection": "Nee",
        "vga_connection": "Nee",
        "thunderbolt_connection": "Ja",
        "headphone_jack": "Ja",
        "keyboard_layout": "QWERTY",
        "physical_keyboard_layout": "ANSI",
        "numeric_keyboard": "Nee",
        "stain_resistant": "Ja",
        "keyboard_backlight": "Ja",
        "mechanical_keyboard": "Nee",
        "programmable_keys": "Nee",
        "microphone": "Ja",
        "amount_of_speakers": "2",
        "audio_type": "Stereo",
        "built_in_camera": "Ja",
        "camera_resolution": "HD (720p)",
        "battery_type": "Lithium-ion",
        "battery_capacity": "18 uur",
        "TPM": "Ja",
        "kensington_lock": "Nee",
        "windows_hello": "Nee",
        "fingerprint_sensor": "Ja",
        "security_class": "Premium",
        "amount_of_free_ram_slots": "0",
        "extra_software": "iWork, Safari",
        "url": "https://www.apple.com/macbook-air-m2"
    },
    {
        "name": "Dell XPS 13 9310",
        "rating": "9,4/10 (73 reviews)",
        "price": "1.799,-",
        "articlenumber": "934578",
        "manufacturercode": "XPS9310-7005SLV",
        "brand": "Dell",
        "warranty": "2 jaar",
        "handling_of_your_defect": "Via Dell",
        "old_device_return_for_free": "Ja",
        "internal_ram_memory": "16 GB",
        "graphics_card_chipset": "Intel Iris Xe Graphics",
        "touchscreen": "Ja",
        "usb_type": "USB-A, USB-C",
        "Recommended_usage": "Zware multitasking, Zakelijk gebruik, Fotobewerking",
        "speed_class": "Hoge prestaties",
        "build_quality": "Premium",
        "screen_diagonal": "13,4 inch",
        "screen_resolution": "4K UHD+ (3840x2400)",
        "screen_resolution_width": "3840 pixels",
        "screen_resolution_height": "2400 pixels",
        "refresh_rate": "60 Hz",
        "touch_screen": "Ja",
        "screen_reflection": "Mat",
        "paneltype": "InfinityEdge",
        "adaptive_sync": "Ja",
        "processor_name": "Intel Core i7",
        "processor_number": "1165G7",
        "processor_core": "Quad core (4)",
        "processor_codename": "Tiger Lake",
        "processor_clockspeed": "2,8 GHz",
        "processor_clockspeed_turbo": "4,7 GHz",
        "processor_cachememory": "12 MB",
        "intern_ram": "16 GB",
        "ram_composition": "1 x 16 GB",
        "ram_slot_1": "16 GB",
        "ram_slots": "1",
        "storage_type": "SSD",
        "total_storage_capacity": "512 GB",
        "storage_disk_type": "SSD",
        "gpu_chipset": "Intel Iris Xe Graphics",
        "gpu_type": "Shared",
        "operating_system": "Windows 10 Pro",
        "operating_system_language": "Meerdere talen in te stellen",
        "model_laptop": "Laptop",
        "color": "Silver",
        "material": "Aluminum",
        "height": "1,48 cm",
        "width": "30,4 cm",
        "depth": "20,8 cm",
        "weight": "1,2 kg",
        "mobile_dataconnection": "Geen",
        "bluetooth": "Ja",
        "bluetooth_version": "5.1",
        "usb_connection": "Ja",
        "amount_of_usb_connections": "3",
        "usb_connection_type": "USB-A, USB-C",
        "protocol_female_usb_c_port": "USB, USB elektriciteit",
        "usb_version_female_usb_c_port": "3.2",
        "video_output_via_usb_c_port": "Ja",
        "amount_of_female_standard_usb_a_ports": "1",
        "usb_version_female_standard_usb_a_ports": "3.0",
        "hdmi_connection": "Nee",
        "displayport_connection": "Ja",
        "vga_connection": "Nee",
        "thunderbolt_connection": "Ja",
        "headphone_jack": "Ja",
        "keyboard_layout": "QWERTY",
        "physical_keyboard_layout": "ANSI",
        "numeric_keyboard": "Nee",
        "stain_resistant": "Ja",
        "keyboard_backlight": "Ja",
        "mechanical_keyboard": "Nee",
        "programmable_keys": "Nee",
        "microphone": "Ja",
        "amount_of_speakers": "2",
        "audio_type": "Waves MaxxAudio",
        "built_in_camera": "Ja",
        "camera_resolution": "HD (720p)",
        "battery_type": "Lithium-ion",
        "battery_capacity": "12 uur",
        "TPM": "Ja",
        "kensington_lock": "Ja",
        "windows_hello": "Ja",
        "fingerprint_sensor": "Ja",
        "security_class": "Premium",
        "amount_of_free_ram_slots": "0",
        "extra_software": "Microsoft Office 365",
        "url": "https://www.dell.com/xps-13-9310"
    }
]

# Convert products into embeddings
product_texts = [json.dumps(product, ensure_ascii=False) for product in products]
product_embeddings = model.encode(product_texts)  # Generate embeddings for all products

# Prepare data for insertion
names = [product["name"] for product in products]
urls = [product["url"] for product in products]

data = [product_embeddings, names, urls]

try:
    collection.insert(data)
    collection.flush()
    print("Multiple products inserted successfully!")
except MilvusException as e:
    print(f"Error inserting data: {e}")

# Step 5: Create an Index
try:
    index_params = {
        "metric_type": "IP",  # Inner Product for similarity search
        "index_type": "IVF_FLAT",
        "params": {"nlist": 128}  # Number of clusters
    }
    collection.create_index(field_name="embedding", index_params=index_params)
    print(f"Index created for collection '{collection_name}'.")
except MilvusException as e:
    print(f"Error creating index: {e}")

# Step 6: Load the collection into memory
try:
    collection.load()
    print(f"Collection '{collection_name}' loaded successfully.")
except MilvusException as e:
    print(f"Error loading collection: {e}")

# Step 7: Search for a Product
query = "A laptop with the best battery life for long hours of usage"
query_vector = model.encode([query])[0]

search_params = {"metric_type": "IP", "params": {"nprobe": 10}}

try:
    search_result = collection.search([query_vector], "embedding", search_params, limit=3, output_fields=["name", "url"])

    # Display search results
    print("\nSearch Results:")
    for result in search_result:
        for item in result:
            print(f"Score: {item.distance}, Product: {item.entity.get('name')}, URL: {item.entity.get('url')}")

except MilvusException as e:
    print(f"Error searching data: {e}")
